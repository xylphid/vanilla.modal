/**
 * Vanilla modal ;) (https://github.com/xylphid)
 * Version 0.1.2
 *
 * @author Anthony PERIQUET
 */
!function(t){var e=null,n={time:null,timeout:!1};t.modal=function(o,i){return this instanceof t.modal?(this.options=t.extend({},t.modal.defaults,i),void("undefined"!=typeof o&&(this.elm=t(o),e=this,t(window).on("resize",function(){e.opened&&(n.time=new Date,n.timeout===!1&&(n.timeout=!0,setTimeout(t.modal.center,200)))}),t(document).on("keydown",function(n){e&&e.opened&&27==n.which&&t.modal.close()})))):new t.modal(o,i)},t.modal.prototype={constructor:t.modal,open:function(e){return e instanceof t&&(this.elm=e),this.setOverlay(),this.setModal(),this.showSpinner(),this.show(),this.opened=!0,!1},setOverlay:function(){t(".overlay").remove(),this.overlay=t("<div>").addClass("overlay").css("background",this.options.overlay).css("bottom",0).css("display","none").css("height","100%").css("left",0).css("opacity",this.options.opacity).css("position","fixed").css("right",0).css("top",0).css("transition","opacity 100ms, z-index 1s").css("width","100%").css("z-index",this.options.zIndex).appendTo("body").fadeIn()},setModal:function(){t(".vanilla-modal").remove(),this.modal=t("<div>").addClass("vanilla-modal").append(t("<a>").addClass("close").on("click",t.modal.close)).appendTo("body").swipe("left",function(){t.modal.next()}).swipe("right",function(){t.modal.prev()}),this.center()},show:function(){o(this.elm.attr("href"))?t.ajax(this.elm.attr("href"),{success:function(t){e.modal.append(t.responseText),e.hideSpinner(),e.center(),e.hideSpinner()}}):(this.modal.append(t(this.elm.attr("href")).outerHtml()),this.center(),this.hideSpinner())},center:function(){this.modal.css("left","50%").css("margin-left",-(this.modal.outerWidth()/2)+"px").css("margin-top",-(this.modal.outerHeight()/2)+"px").css("position","fixed").css("top","50%").css("z-index",this.options.zIndex+1)},showSpinner:function(){this.working=!0,this.options.showSpinner&&(this.spinner=this.spinner||t("<div>").addClass("spinner"),this.modal.append(this.spinner))},hideSpinner:function(){this.spinner&&this.spinner.remove(),this.working=!1},close:function(){this.modal.css("opacity",0).css("z-index",-1),this.overlay.css("opacity",0).css("z-index",-1),this.opened=!1}},t.modal.defaults={opacity:.75,overlay:"#000",showSpinner:!0,zIndex:1},t.modal.dispatcher=function(t,n){return e&&"function"==typeof e[n]?(/Event/.test(t)&&t.preventDefault(),e[n](t),e):void 0},t.modal.open=function(e){return t.modal.dispatcher(e,"open")},t.modal.close=function(e){return t.modal.dispatcher(e,"close")},t.modal.resize=function(e){t.modal.dispatcher(e,"resize")};var o=function(t){try{return document.querySelectorAll(t),!1}catch(e){return!0}};t.prototype.modal=function(n){return this instanceof t&&(e=new t.modal(this,n),t.modal.open()),this},t(document).on("click","a[data-modal]",function(e){e.preventDefault(),t(e.value).modal()})}(vanilla);